# HealthyPi 5 Specific Configuration
CONFIG_HEALTHYPI_USB_CDC_ENABLED=y
CONFIG_HEALTHYPI_USB_MSC_ENABLED=n
CONFIG_HEALTHYPI_BLE_ENABLED=y
#CONFIG_HEALTHYPI_DISPLAY_ENABLED=n

CONFIG_DISK_ACCESS=y
CONFIG_DISK_DRIVER_SDMMC=y

CONFIG_FAT_FILESYSTEM_ELM=y
CONFIG_HEALTHYPI_SD_CARD_ENABLED=y

# Memory Configuration
CONFIG_HEAP_MEM_POOL_SIZE=32528
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=12288
CONFIG_MAIN_STACK_SIZE=4096

# Zephyr OS Configuration
CONFIG_SMF=y
CONFIG_EVENTS=y
CONFIG_LOG=y
CONFIG_CBPRINTF_FP_SUPPORT=y

# Debug Configuration - Stack Overflow Detection
# Disabled to reduce RAM usage (was at 99.24%)
CONFIG_THREAD_STACK_INFO=n
CONFIG_THREAD_MONITOR=n
CONFIG_INIT_STACKS=n
CONFIG_THREAD_NAME=n
CONFIG_STACK_SENTINEL=y
#CONFIG_THREAD_ANALYZER=y
#CONFIG_THREAD_ANALYZER_AUTO=y
#CONFIG_THREAD_ANALYZER_AUTO_INTERVAL=60

# Runtime Checks and Assertions - Keep for crash detection
CONFIG_ASSERT=y
CONFIG_ASSERT_LEVEL=2

# Exception/Fault Debugging
CONFIG_EXTRA_EXCEPTION_INFO=y

# Logging buffer
CONFIG_LOG_BUFFER_SIZE=2048

# Peripheral device drivers
CONFIG_SENSOR=y
CONFIG_SENSOR_MAX30001=y
CONFIG_SENSOR_AFE4400=y
CONFIG_SENSOR_MAX30205=y
CONFIG_I2C=y
CONFIG_I2C_LOG_LEVEL_OFF=y
CONFIG_FUEL_GAUGE=y

CONFIG_SENSOR_ASYNC_API=y

CONFIG_ADC=y
CONFIG_LED=y
CONFIG_GPIO=y
CONFIG_SERIAL=y
CONFIG_UART_INTERRUPT_DRIVEN=y
CONFIG_SERIAL=y
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y
CONFIG_UART_LINE_CTRL=y

CONFIG_REBOOT=y

# Hardware watchdog - 8 second timeout to detect hard faults
CONFIG_WATCHDOG=y

# Filesystem & Internal Flash support to store data
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y
CONFIG_MPU_ALLOW_FLASH_WRITE=y

# Enabled settings module and FS to store settings
CONFIG_SETTINGS=y
CONFIG_SETTINGS_RUNTIME=y
CONFIG_SETTINGS_FILE=y
CONFIG_SETTINGS_FILE_PATH="/lfs/settings"

# USB Configuration
CONFIG_USB_DEVICE_STACK=y
CONFIG_USB_DEVICE_PRODUCT="HealthyPi 5"
CONFIG_USB_DEVICE_PID=0x0001
CONFIG_USB_DEVICE_VID=4440
CONFIG_USB_DEVICE_INITIALIZE_AT_BOOT=n
CONFIG_USB_DRIVER_LOG_LEVEL_ERR=y
CONFIG_USB_DEVICE_LOG_LEVEL_ERR=y
CONFIG_USB_CDC_ACM_RINGBUF_SIZE=2048

# Enable MCUmgr and dependencies.
CONFIG_NET_BUF=y
CONFIG_ZCBOR=y
CONFIG_CRC=y
CONFIG_MCUMGR=y
CONFIG_STREAM_FLASH=y
CONFIG_FLASH_MAP=y

CONFIG_BASE64=y
CONFIG_CONSOLE=y

CONFIG_PRINTK=y

CONFIG_INPUT=y

CONFIG_REQUIRES_FULL_LIBC=y
CONFIG_REQUIRES_FLOAT_PRINTF=y

CONFIG_CMSIS_DSP=y
CONFIG_CMSIS_DSP_FILTERING=y
# Ensure an MCUboot-compatible binary is generated.
#CONFIG_BOOTLOADER_MCUBOOT=y

# Tensorflow Lite Configuration
#CONFIG_CPP=y
#CONFIG_LIB_CPLUSPLUS=y
#CONFIG_NEWLIB_LIBC=y
#CONFIG_TENSORFLOW_LITE_MICRO=y
#CONFIG_TENSORFLOW_LITE_MICRO_CMSIS_NN_KERNELS=y

CONFIG_LOG=y
CONFIG_UART_CONSOLE=y

CONFIG_ENTROPY_GENERATOR=y
CONFIG_TEST_RANDOM_GENERATOR=y

CONFIG_LV_USE_LOG=y
CONFIG_LV_LOG_LEVEL_ERROR=y

CONFIG_DISPLAY_LOG_LEVEL_DBG=n
CONFIG_INPUT_LOG_LEVEL_DBG=n
CONFIG_SENSOR_LOG_LEVEL_WRN=y
CONFIG_MAX30001_LOG_LEVEL_WRN=y

## Bluetooth Configuration
# BT Host only configuration
CONFIG_BT=y
CONFIG_BT_HCI=y

CONFIG_BT_PERIPHERAL=y
CONFIG_BT_BAS=y
CONFIG_BT_HRS=y
CONFIG_BT_DEVICE_NAME="healthypi 5"

# BT HCI H4 Controller logs
CONFIG_BT_LOG_LEVEL_ERR=y
CONFIG_BT_HCI_DRIVER_LOG_LEVEL_ERR=y
CONFIG_BT_LL_SW_SPLIT=n

CONFIG_BT_ATT_TX_COUNT=50
CONFIG_BT_HCI_TX_STACK_SIZE_WITH_PROMPT=y
CONFIG_BT_HCI_TX_STACK_SIZE=4096
CONFIG_BT_RX_STACK_SIZE=4096

CONFIG_BT_ATT_PREPARE_COUNT=2
CONFIG_BT_L2CAP_TX_MTU=96
#CONFIG_BT_BUF_ACL_RX_SIZE=32777
#CONFIG_BT_BUF_ACL_RX_SIZE=502
#CONFIG_BT_BUF_ACL_TX_SIZE=502

CONFIG_BT_BUF_ACL_RX_SIZE=255
CONFIG_BT_BUF_ACL_TX_SIZE=251
CONFIG_BT_BUF_CMD_TX_SIZE=255

CONFIG_ZBUS=y